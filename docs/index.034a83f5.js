function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},r={},l=n.parcelRequireed3d;null==l&&((l=function(e){if(e in o)return o[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){r[e]=t},n.parcelRequireed3d=l),l.register("27Lyk",(function(t,n){var o,r;e(t.exports,"register",(()=>o),(e=>o=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var l={};o=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)l[t[n]]=e[t[n]]},r=function(e){var t=l[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),l("27Lyk").register(JSON.parse('{"6evGa":"index.034a83f5.js","55edQ":"1.4174c112.png","99rIB":"2.672c92e3.png","aLMx8":"4.1e9ab26e.png"}'));var i;i=new URL(l("27Lyk").resolve("55edQ"),import.meta.url).toString();var a;a=new URL(l("27Lyk").resolve("99rIB"),import.meta.url).toString();var d;d=new URL(l("27Lyk").resolve("aLMx8"),import.meta.url).toString();var s,c;c=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],o=0;o<e.rangeCount;o++)n.push(e.getRangeAt(o));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}};var u={"text/plain":"Text","text/html":"Url",default:"Text"};s=function(e,t){var n,o,r,l,i,a,d=!1;t||(t={}),n=t.debug||!1;try{if(r=c(),l=document.createRange(),i=document.getSelection(),(a=document.createElement("span")).textContent=e,a.style.all="unset",a.style.position="fixed",a.style.top=0,a.style.clip="rect(0, 0, 0, 0)",a.style.whiteSpace="pre",a.style.webkitUserSelect="text",a.style.MozUserSelect="text",a.style.msUserSelect="text",a.style.userSelect="text",a.addEventListener("copy",(function(o){if(o.stopPropagation(),t.format)if(o.preventDefault(),void 0===o.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=u[t.format]||u.default;window.clipboardData.setData(r,e)}else o.clipboardData.clearData(),o.clipboardData.setData(t.format,e);t.onCopy&&(o.preventDefault(),t.onCopy(o.clipboardData))})),document.body.appendChild(a),l.selectNodeContents(a),i.addRange(l),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");d=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),d=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),o=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,e)}}finally{i&&("function"==typeof i.removeRange?i.removeRange(l):i.removeAllRanges()),a&&document.body.removeChild(a),r()}return d};var f=16;function m([e,t],n=1){return[[e,t],[20-t,e],[20-e,20-t],[t,20-e]]}function g(e,t){let n=t.reduce(((e,t)=>e[t]),e);return"number"!=typeof n?0:n}let p=document.getElementById("target"),h=document.getElementById("editor"),y=document.getElementById("guide"),v=document.getElementById("render");var w=h.getContext("2d"),b=y.getContext("2d"),E=v.getContext("2d");function L(){w.clearRect(0,0,h.width,h.height)}function x(e,t){E.fill();for(let n=0;n<3;n++)for(let o=0;o<3;o++)for(let r=0;r<7;r++)for(let l=0;l<7;l++){let i=g(e,[n,o,r,l]);w.fillStyle=1==i?window.paintColor:"#fff0",E.fillStyle=1==i?window.paintColor:"#fff0";let a=(7*n+r)*t,d=(7*o+l)*t;1==n&&1==o||(E.clearRect(a,d,t,t),E.fillRect(a,d,t,t),a*=f/t,d*=f/t,w.fillRect(a+1,d+1,15,15))}}function C(e){let t=v.toDataURL(),n=document.getElementById("border-style");n&&n.remove(),n=document.createElement("style"),n.id="border-style",document.head.appendChild(n);let o=7*e,r=`.broider {\n    border-image:  url("${t}") ${o} /  ${o}px / 0 round;\n    border-width:  ${o}px;\n    border-style:  solid;\n}`;n.sheet.insertRule(r),p.textContent=r}function R(e,t){let n=7*t[0]+t[2],o=7*t[1]+t[3];w.fillStyle=(g(e,t),"#dde"),1==t[0]&&1==t[1]||w.fillRect(n*f+0,o*f+0,16,16)}function k(){p.setAttribute("data-after","[Click to copy]")}function S(e,t,n){let o=7*n,r=`border-image:  url('${e}') ${o} /  ${o}px / 0 round;\n    border-width:  ${o}px;\n    border-style:  solid; `;return`\n<pre class="gallery-line" data-after="[Click to copy]" style="${r}">\n  ${`.${t} {\n    ${r}\n  }`}\n</pre>\n  `}E.imageSmoothingEnabled=!1,p.addEventListener("click",(function(){t(s)(p.textContent,{message:"Press #{key} to copy css"}),p.setAttribute("data-after","Copied to your clipboard!"),p.classList.remove("flash"),window.setTimeout((()=>{p.classList.add("flash")}),1),window.setTimeout(k,2500)})),k();let T=document.getElementById("title"),D=document.getElementById("submit"),I=document.getElementById("gallery"),B=document.getElementById("render"),A=[];function U(){let e=A.map((e=>S(e.dataUrl,e.title,e.pixelRatio)));I.innerHTML=e.join(""),document.querySelectorAll(".gallery-line").forEach((e=>{e.addEventListener("click",(()=>{t(s)(e.textContent),e.setAttribute("data-after","Copied to your clipboard!"),e.classList.remove("flash"),window.setTimeout((()=>{e.classList.add("flash")}),1),window.setTimeout((()=>{e.setAttribute("data-after","[Click to copy]")}),2500)}))}))}!async function(){console.log("fetching submissions");let e=await fetch("https://maxbittker-broider.web.val.run/").then((e=>e.json()));A=e.submissions,console.log(A),U()}(),D.addEventListener("click",(()=>{let e=B.toDataURL(),t=parseInt(B.dataset.pixelRatio);var n;A.push({title:(n=T.value,(n=(n=(n=n.toLowerCase()).replace(/ /g,"-")).replace(/[^a-z0-9-_]/g,""))&&!/^[a-z_]/.test(n)&&(n="_"+n),n),dataUrl:e,pixelRatio:t,who:""}),async function(e){let t=await fetch("https://maxbittker-broider.web.val.run/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json()));A=t.submissions,U()}(A[A.length-1]),U()}));let _=document.getElementById("pen"),O=document.getElementById("eraser"),$=document.getElementById("symmetry"),M=document.getElementById("undo"),P=document.getElementById("scale"),N=document.getElementById("color"),H=document.getElementById("editor-frame"),j=document.getElementById("editor"),X=document.getElementById("guide"),F=document.getElementById("render");j.width=336,j.height=336,X.width=336,X.height=336;let J=2,Y=[1,2,4],z=[t(i),t(a),t(d)],q=Y[J];function Q(){H.style.height=j.getBoundingClientRect().width+"px"}F.width=7*q*3,F.height=7*q*3,F.dataset.pixelRatio=q.toString(),P.addEventListener("click",(()=>{J=(J+1)%Y.length,P.src=z[J],q=Y[J],F.width=7*q*3,F.height=7*q*3,F.dataset.pixelRatio=q.toString(),x(V,q),C(q),Q()})),window.paintColor="#000",N.addEventListener("input",(e=>{window.paintColor=e.target.value,x(V,q),C(q)})),document.addEventListener("DOMContentLoaded",Q),window.addEventListener("resize",Q);var G=!1,W=!1,K=!0;$.addEventListener("click",(e=>{K=!K,$.classList.toggle("selected")})),O.addEventListener("click",(e=>{W=!0,O.classList.add("selected"),_.classList.remove("selected")})),_.addEventListener("click",(e=>{W=!1,_.classList.add("selected"),O.classList.remove("selected")}));var V=new Array(3).fill(0).map(((e,t)=>new Array(3).fill(0).map(((e,t)=>new Array(7).fill(0).map(((e,t)=>new Array(7).fill(0)))))));let Z=[JSON.stringify(V)];function ee(){let e=JSON.stringify(V);e!=Z[Z.length-1]&&(Z.push(e),Z.length>50&&Z.shift(),M.classList.add("selected"))}M.addEventListener("click",(e=>{!function(){Z.pop();let e=Z[Z.length-1];e&&(V=JSON.parse(e),L(),x(V,q),C(q))}(),Z.length<2&&M.classList.remove("selected"),e.preventDefault()})),function(){for(let e=1;e<3;e++){b.strokeStyle="#33f",b.lineWidth=.5;let t=e*h.width/3;b.beginPath(),b.moveTo(t,0),b.lineTo(t,h.height),b.stroke(),b.beginPath(),b.moveTo(0,t),b.lineTo(h.height,t),b.stroke()}for(let e=0;e<21;e++){b.strokeStyle="#ccc";let t=e*h.width/21;b.beginPath(),b.moveTo(t,0),b.lineTo(t,h.height),b.stroke(),b.beginPath(),b.moveTo(0,t),b.lineTo(h.height,t),b.stroke()}let e=h.width/3;b.clearRect(e+1,e+1,e-2,e-2),b.beginPath(),b.moveTo(1*e,2*e),b.lineTo(2*e,1*e),b.stroke(),b.beginPath(),b.moveTo(1*e,1*e),b.lineTo(2*e,2*e),b.stroke()}(),x(V,q),C(q);let te=(e,t=!1,n=!1)=>{let{left:o,top:r,width:l,height:i}=j.getBoundingClientRect(),a=e.clientX-o,d=e.clientY-r,s=a/l*j.width,c=d/i*j.height,u=Math.floor(s/f),p=Math.floor(c/f),h=K?m([u,p]):[[u,p]];L(),h.forEach((([e,o])=>{let r=Math.floor(e/7),l=Math.floor(o/7),i=[r,l,e%7,o%7];if(r<0||r>2||l<0||l>2)return;n&&R(V,i);let a=g(V,i);t||(a=0),W&&(a=1),function(e,t){G&&function(e,t,n=1){let o=t.slice(0,-1),r=t[t.length-1];o.reduce(((e,t)=>e[t]),e)[r]=n}(V,e,1-t)}(i,a)})),x(V,q),window.setTimeout((()=>C(q)),0)};j.addEventListener("mousedown",(e=>{G=!0,te(e,!0)})),j.addEventListener("mousemove",(e=>{te(e,!1,!0)})),j.addEventListener("mouseout",(e=>{L(),x(V,q)})),window.addEventListener("mousedown",(()=>{G=!0})),window.addEventListener("mouseup",(()=>{G=!1,ee()})),j.addEventListener("touchend",(e=>{G=!1,ee()})),j.addEventListener("touchstart",(e=>{G=!0,e.preventDefault();const t=e.targetTouches;for(let n=0;n<t.length;n++)e.clientX=t[n].clientX,e.clientY=t[n].clientY,te(e)})),j.addEventListener("touchmove",(e=>{e.preventDefault(),G=!0;const t=e.targetTouches;for(let n=0;n<t.length;n++)e.clientX=t[n].clientX,e.clientY=t[n].clientY,te(e)}));let ne=0;window.addEventListener("touchend",(e=>{e.timeStamp-ne<=500&&(e.preventDefault(),e.target.click()),G=!1,ne=e.timeStamp})),U();
//# sourceMappingURL=index.034a83f5.js.map
