{"mappings":"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","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-3d234b162569c2eb.js","node_modules/@parcel/runtime-js/lib/runtime-8e1835d74d5b95be.js","node_modules/@parcel/runtime-js/lib/runtime-bd7cc2acba6ae9eb.js","node_modules/@parcel/runtime-js/lib/runtime-d37ce51439b5300f.js","node_modules/toggle-selection/index.js","node_modules/copy-to-clipboard/index.js","src/state.ts","src/utils.ts","src/render.ts","src/gallery.ts","index.ts"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"6evGa\\\":\\\"index.eca9f7b2.js\\\",\\\"55edQ\\\":\\\"1.4174c112.png\\\",\\\"99rIB\\\":\\\"2.672c92e3.png\\\",\\\"aLMx8\\\":\\\"4.1e9ab26e.png\\\"}\"));","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"55edQ\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"99rIB\")).toString();","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"aLMx8\")).toString();","\nmodule.exports = function () {\n  var selection = document.getSelection();\n  if (!selection.rangeCount) {\n    return function () {};\n  }\n  var active = document.activeElement;\n\n  var ranges = [];\n  for (var i = 0; i < selection.rangeCount; i++) {\n    ranges.push(selection.getRangeAt(i));\n  }\n\n  switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n    case 'INPUT':\n    case 'TEXTAREA':\n      active.blur();\n      break;\n\n    default:\n      active = null;\n      break;\n  }\n\n  selection.removeAllRanges();\n  return function () {\n    selection.type === 'Caret' &&\n    selection.removeAllRanges();\n\n    if (!selection.rangeCount) {\n      ranges.forEach(function(range) {\n        selection.addRange(range);\n      });\n    }\n\n    active &&\n    active.focus();\n  };\n};\n","\"use strict\";\n\nvar deselectCurrent = require(\"toggle-selection\");\n\nvar clipboardToIE11Formatting = {\n  \"text/plain\": \"Text\",\n  \"text/html\": \"Url\",\n  \"default\": \"Text\"\n}\n\nvar defaultMessage = \"Copy to clipboard: #{key}, Enter\";\n\nfunction format(message) {\n  var copyKey = (/mac os x/i.test(navigator.userAgent) ? \"⌘\" : \"Ctrl\") + \"+C\";\n  return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n  var debug,\n    message,\n    reselectPrevious,\n    range,\n    selection,\n    mark,\n    success = false;\n  if (!options) {\n    options = {};\n  }\n  debug = options.debug || false;\n  try {\n    reselectPrevious = deselectCurrent();\n\n    range = document.createRange();\n    selection = document.getSelection();\n\n    mark = document.createElement(\"span\");\n    mark.textContent = text;\n    // reset user styles for span element\n    mark.style.all = \"unset\";\n    // prevents scrolling to the end of the page\n    mark.style.position = \"fixed\";\n    mark.style.top = 0;\n    mark.style.clip = \"rect(0, 0, 0, 0)\";\n    // used to preserve spaces and line breaks\n    mark.style.whiteSpace = \"pre\";\n    // do not inherit user-select (it may be `none`)\n    mark.style.webkitUserSelect = \"text\";\n    mark.style.MozUserSelect = \"text\";\n    mark.style.msUserSelect = \"text\";\n    mark.style.userSelect = \"text\";\n    mark.addEventListener(\"copy\", function(e) {\n      e.stopPropagation();\n      if (options.format) {\n        e.preventDefault();\n        if (typeof e.clipboardData === \"undefined\") { // IE 11\n          debug && console.warn(\"unable to use e.clipboardData\");\n          debug && console.warn(\"trying IE specific stuff\");\n          window.clipboardData.clearData();\n          var format = clipboardToIE11Formatting[options.format] || clipboardToIE11Formatting[\"default\"]\n          window.clipboardData.setData(format, text);\n        } else { // all other browsers\n          e.clipboardData.clearData();\n          e.clipboardData.setData(options.format, text);\n        }\n      }\n      if (options.onCopy) {\n        e.preventDefault();\n        options.onCopy(e.clipboardData);\n      }\n    });\n\n    document.body.appendChild(mark);\n\n    range.selectNodeContents(mark);\n    selection.addRange(range);\n\n    var successful = document.execCommand(\"copy\");\n    if (!successful) {\n      throw new Error(\"copy command was unsuccessful\");\n    }\n    success = true;\n  } catch (err) {\n    debug && console.error(\"unable to copy using execCommand: \", err);\n    debug && console.warn(\"trying IE specific stuff\");\n    try {\n      window.clipboardData.setData(options.format || \"text\", text);\n      options.onCopy && options.onCopy(window.clipboardData);\n      success = true;\n    } catch (err) {\n      debug && console.error(\"unable to copy using clipboardData: \", err);\n      debug && console.error(\"falling back to prompt\");\n      message = format(\"message\" in options ? options.message : defaultMessage);\n      window.prompt(message, text);\n    }\n  } finally {\n    if (selection) {\n      if (typeof selection.removeRange == \"function\") {\n        selection.removeRange(range);\n      } else {\n        selection.removeAllRanges();\n      }\n    }\n\n    if (mark) {\n      document.body.removeChild(mark);\n    }\n    reselectPrevious();\n  }\n\n  return success;\n}\n\nmodule.exports = copy;\n","var tileSize = 7;\nvar editorRatio = 16;\n\nexport {tileSize, editorRatio};\n","import { tileSize } from './state';\n\nfunction newCell() {\n  let rows = new Array(tileSize).fill(0);\n  return rows.map((v, i) => new Array(tileSize).fill(0));\n}\nfunction newGrid() {\n  let rows = new Array(3).fill(0);\n  return rows.map((v, i) => {\n    let col = new Array(3).fill(0);\n    return col.map((v, i) => newCell());\n  });\n}\n\nfunction rotatePair([x, y]) {\n  let gridSize = 3 * tileSize;\n  return [gridSize - y, x];\n}\nfunction rotationSet([x, y], n = 1) {\n  let gridSize = 3 * tileSize - 1;\n\n  return [\n    [x, y], [gridSize - y, x], [gridSize - x, gridSize - y], [y, gridSize - x]\n  ];\n}\nfunction getLoc(map: any[][][][], loc: number[]): number {\n  let r = loc.reduce((acc, i) => acc[i], map);\n  if (typeof r !== 'number') {\n    return 0;\n  } else {\n    return r;\n  }\n}\n\nfunction setLoc(map: any[][][][], loc: any[], v: number = 1) {\n  let address = loc.slice(0, -1);\n  let lastPos = loc[loc.length - 1];\n\n  address.reduce((acc, i) => acc[i], map)[lastPos] = v;\n}\n\nexport function hexToRgb(hex: string): { r: number, g: number, b: number } | null {\n  const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? {\n    r: parseInt(result[1], 16),\n    g: parseInt(result[2], 16),\n    b: parseInt(result[3], 16)\n  } : null;\n}\n\nexport { newGrid, getLoc, setLoc, rotatePair, rotationSet };\n","import copy from \"copy-to-clipboard\";\n\nimport { editorRatio, tileSize } from \"./state\";\nimport { getLoc } from \"./utils\";\n\nlet target = <HTMLElement>document.getElementById(\"target\");\n\n// let vectortarget = <HTMLElement>document.getElementById('vector-target');\n\nlet canvas: HTMLCanvasElement = <HTMLCanvasElement>(\n  document.getElementById(\"editor\")\n);\nlet guideCanvas: HTMLCanvasElement = <HTMLCanvasElement>(\n  document.getElementById(\"guide\")\n);\nlet renderCanvas: HTMLCanvasElement = <HTMLCanvasElement>(\n  document.getElementById(\"render\")\n);\nvar ctx = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\nvar guideCtx = guideCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\nvar renderCtx = renderCanvas.getContext(\"2d\") as CanvasRenderingContext2D;\n\nrenderCtx.imageSmoothingEnabled = false;\nfunction cleanMap() {\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n}\nfunction renderMap(map, pixelRatio) {\n  renderCtx.fill();\n\n  for (let sx = 0; sx < 3; sx++) {\n    for (let sy = 0; sy < 3; sy++) {\n      for (let cx = 0; cx < tileSize; cx++) {\n        for (let cy = 0; cy < tileSize; cy++) {\n          let v = getLoc(map, [sx, sy, cx, cy]);\n\n          ctx.fillStyle = v == 1 ? window.paintColor : \"#fff0\";\n          renderCtx.fillStyle = v == 1 ? window.paintColor : \"#fff0\";\n          let gridX = (sx * tileSize + cx) * pixelRatio;\n          let gridY = (sy * tileSize + cy) * pixelRatio;\n          if (sx == 1 && sy == 1) {\n            continue;\n          }\n          renderCtx.clearRect(gridX, gridY, pixelRatio, pixelRatio);\n          renderCtx.fillRect(gridX, gridY, pixelRatio, pixelRatio);\n          gridX *= editorRatio / pixelRatio;\n          gridY *= editorRatio / pixelRatio;\n          ctx.fillRect(gridX + 1, gridY + 1, editorRatio - 1, editorRatio - 1);\n        }\n      }\n    }\n  }\n  // renderVector(map, pixelRatio)\n}\nfunction drawGuide() {\n  for (let index = 1; index < 3; index++) {\n    guideCtx.strokeStyle = \"#33f\";\n    guideCtx.lineWidth = 0.5;\n    let x = (index * canvas.width) / 3;\n    guideCtx.beginPath();\n    guideCtx.moveTo(x, 0);\n    guideCtx.lineTo(x, canvas.height);\n    guideCtx.stroke();\n    guideCtx.beginPath();\n    guideCtx.moveTo(0, x);\n    guideCtx.lineTo(canvas.height, x);\n    guideCtx.stroke();\n  }\n\n  for (let index = 0.0; index < 3 * tileSize; index++) {\n    guideCtx.strokeStyle = \"#ccc\";\n    let x = (index * canvas.width) / (3 * tileSize);\n    guideCtx.beginPath();\n    guideCtx.moveTo(x, 0);\n    guideCtx.lineTo(x, canvas.height);\n    guideCtx.stroke();\n    guideCtx.beginPath();\n    guideCtx.moveTo(0, x);\n    guideCtx.lineTo(canvas.height, x);\n    guideCtx.stroke();\n  }\n  let third = canvas.width / 3;\n  guideCtx.clearRect(third + 1, third + 1, third - 2, third - 2);\n  guideCtx.beginPath();\n  guideCtx.moveTo(third * 1, third * 2);\n  guideCtx.lineTo(third * 2, third * 1);\n  guideCtx.stroke();\n  guideCtx.beginPath();\n  guideCtx.moveTo(third * 1, third * 1);\n  guideCtx.lineTo(third * 2, third * 2);\n  guideCtx.stroke();\n}\n\nfunction setBorder(pixelRatio) {\n  let dataURI = renderCanvas.toDataURL();\n  // let dataURI2 = renderVector(map, pixelRatio);\n\n  // console.log(dataURI.length);\n  // console.log(dataURI2.length);\n  let style = <HTMLStyleElement>document.getElementById(\"border-style\");\n  if (style) style.remove();\n  style = document.createElement(\"style\");\n  style.id = \"border-style\";\n  document.head.appendChild(style);\n\n  let viewsize = tileSize * pixelRatio;\n  let css = `.broider {\n    border-image:  url(\"${dataURI}\") ${viewsize} /  ${viewsize}px / 0 round;\n    border-width:  ${viewsize}px;\n    border-style:  solid;\n}`;\n  style.sheet.insertRule(css);\n  target.textContent = css;\n}\n// function svgToDataURL(svgStr) {\n//   const encoded =\n//     encodeURIComponent(svgStr).replace(/'/g, '%27').replace(/\"/g, '%22')\n\n//   const header = 'data:image/svg+xml,'\n//   const dataUrl = header + encoded\n//   return dataUrl\n// }\n\n// function renderVector(map, pixelRatio) {\n//   let content = `<svg\n//       width=\"${tileSize * pixelRatio * 3}px\"\n//       height=\"${tileSize * pixelRatio * 3}px\"\n//       viewBox=\"0 0 ${tileSize * pixelRatio * 3} ${tileSize * pixelRatio * 3}\"\n//       fill=\"red\"\n//       stroke=\"none\"\n//       xmlns=\"http://www.w3.org/2000/svg\"\n//       >`;\n//   for (let sx = 0; sx < 3; sx++) {\n//     for (let sy = 0; sy < 3; sy++) {\n//       for (let cx = 0; cx < tileSize; cx++) {\n//         for (let cy = 0; cy < tileSize; cy++) {\n//           let v = getLoc(map, [sx, sy, cx, cy]);\n\n//           let gridX = (sx * tileSize + cx) * pixelRatio;\n//           let gridY = (sy * tileSize + cy) * pixelRatio;\n\n//           if (sx == 1 && sy == 1) {\n//             continue;\n//           }\n\n//           if (v == 1) {\n//             content += `<rect x=\"${gridX}\" y=\"${gridY}\" width=\"${pixelRatio}px\" height=\"${pixelRatio}px\"/>`;\n//           }\n//         }\n//       }\n//     }\n//   }\n//   // console.log(content)\n//   content += '</svg>';\n//   // vectortarget.innerHTML = content;\n//   let dataURI = svgToDataURL(content);\n//   return dataURI\n\n//   // vector.setAttribute(\n//   // 'viewBox',\n//   // `0 0 ${tileSize * pixelRatio * 3} ${tileSize * pixelRatio *\n//   // 3}`);\n//   // vector.innerHTML = content;\n// }\nfunction renderHover(map: any[][][][], loc: number[]) {\n  let x = loc[0] * tileSize + loc[2];\n  let y = loc[1] * tileSize + loc[3];\n  ctx.fillStyle = getLoc(map, loc) == 1 ? \"#dde\" : \"#dde\";\n  if (loc[0] == 1 && loc[1] == 1) {\n    return;\n  }\n  ctx.fillRect(\n    x * editorRatio + 0,\n    y * editorRatio + 0,\n    editorRatio - 0,\n    editorRatio - 0\n  );\n}\n\ntarget.addEventListener(\"click\", copyTarget);\nfunction resetCopy() {\n  target.setAttribute(\"data-after\", \"[Click to copy]\");\n}\n\nresetCopy();\nfunction copyTarget() {\n  copy(target.textContent, { message: \"Press #{key} to copy css\" });\n  target.setAttribute(\"data-after\", \"Copied to your clipboard!\");\n  target.classList.remove(\"flash\");\n\n  window.setTimeout(() => {\n    target.classList.add(\"flash\");\n  }, 1);\n  window.setTimeout(resetCopy, 2500);\n}\n\nfunction galleryLineString(\n  dataURI: string,\n  title: string,\n  pixelRatio: number,\n  index: number\n) {\n  if (!dataURI) {\n    return \"\";\n  }\n\n  const viewsize = tileSize * pixelRatio;\n  const escapedDataURI = encodeURI(dataURI);\n  const styles = `border-image:  url('${escapedDataURI}') ${viewsize} /  ${viewsize}px / 0 round;\\n    border-width:  ${viewsize}px;\\n    border-style:  solid; `;\n  const escapedTitle = escapeHtml(title);\n  const css = `.${escapedTitle} {\\n    ${styles}\\n  }`;\n\n  const escapedStyles = escapeHtml(styles);\n  const escapedCSS = escapeHtml(css);\n\n  const html = `\n  <pre class=\"gallery-line\" data-after=\"[Click to copy]\" style=\"${escapedStyles}\" data-index=\"${index}\">\n    ${escapedCSS}\n  </pre>\n    `;\n  return html;\n}\n\nfunction escapeHtml(unsafe: string): string {\n  return unsafe\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#039;\");\n}\n\nexport {\n  cleanMap,\n  renderMap,\n  drawGuide,\n  setBorder,\n  renderHover,\n  galleryLineString,\n};\n","import copy from \"copy-to-clipboard\";\nimport { galleryLineString } from \"./render\";\nimport { loadSubmissionIntoEditor } from \"../index\";\n\nfunction to_css_class(string: string): string {\n  // Convert to lowercase\n  string = string.toLowerCase();\n  // Replace spaces with hyphens\n  string = string.replace(/ /g, \"-\");\n  // Remove invalid characters using regex\n  string = string.replace(/[^a-z0-9-_]/g, \"\");\n  // Ensure the first character is a letter or underscore\n  if (string && !/^[a-z_]/.test(string)) {\n    string = \"_\" + string;\n  }\n  return string;\n}\n\nlet title = document.getElementById(\"title\");\nlet submit = document.getElementById(\"submit\");\nlet gallery = document.getElementById(\"gallery\");\nlet renderCanvas: HTMLCanvasElement = <HTMLCanvasElement>(\n  document.getElementById(\"render\")\n);\n\nexport interface submission {\n  dataUrl: string;\n  title: string;\n  pixelRatio: number;\n  who: string;\n}\nlet submissions: submission[] = [];\n\nasync function fetchSubmissions() {\n  //fetch posts from:\n  // https://maxbittker-broider.web.val.run/\n  let data = await fetch(\"https://maxbittker-broider.web.val.run/\").then(\n    (res) => res.json()\n  );\n\n  submissions = data.submissions;\n  console.log(\"submissions\", submissions);\n  setupGallery();\n}\n\nasync function postSubmission(submission: submission) {\n  //post submission to:\n  // https://maxbittker-broider.web.val.run/\n  let data = await fetch(\"https://maxbittker-broider.web.val.run/\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(submission),\n  }).then((res) => res.json());\n  submissions = data.submissions;\n  setupGallery();\n}\nfetchSubmissions();\n\nsubmit!.addEventListener(\"click\", () => {\n  let dataURI = renderCanvas.toDataURL();\n  let pixelRatio = parseInt(renderCanvas.dataset.pixelRatio);\n  submissions.push({\n    title: to_css_class(title.value),\n    dataUrl: dataURI,\n    pixelRatio: pixelRatio,\n    who: \"\",\n  });\n\n  // window.localStorage.setItem(\"submissions\", JSON.stringify(submissions));\n  postSubmission(submissions[submissions.length - 1]);\n  setupGallery();\n});\nfunction setupGallery() {\n  let submissionHTMLs = submissions.map((submission, index) => {\n    return galleryLineString(\n      submission.dataUrl,\n      submission.title,\n      submission.pixelRatio,\n      index\n    );\n  });\n  gallery!.innerHTML = submissionHTMLs.join(\"\");\n  document.querySelectorAll(\".gallery-line\").forEach((line) => {\n    line.addEventListener(\"click\", (e) => {\n      const target = e.target as HTMLElement;\n      const index = parseInt(target.dataset.index);\n      loadSubmissionIntoEditor(submissions[index]);\n      copy(line.textContent);\n      line.setAttribute(\"data-after\", \"Copied to your clipboard!\");\n      line.classList.remove(\"flash\");\n      window.setTimeout(() => {\n        line.classList.add(\"flash\");\n      }, 1);\n      window.setTimeout(() => {\n        line.setAttribute(\"data-after\", \"[Click to copy]\");\n      }, 2500);\n    });\n  });\n}\n\nexport { setupGallery };\n","import onePng from './assets/1.png';\nimport twoPng from './assets/2.png';\nimport fourPng from './assets/4.png';\nimport { hexToRgb } from './src/utils';\nimport { cleanMap, drawGuide, renderHover, renderMap, setBorder } from './src/render';\nimport { editorRatio, tileSize } from './src/state';\nimport { getLoc, newGrid, rotationSet, setLoc } from './src/utils';\nimport { setupGallery, submission } from './src/gallery';\nlet penElement = <HTMLElement>document.getElementById('pen');\nlet eraserElement = <HTMLElement>document.getElementById('eraser');\nlet symmetryElement = <HTMLElement>document.getElementById('symmetry');\nlet undoElement = <HTMLImageElement>document.getElementById('undo');\nlet scaleElement = <HTMLImageElement>document.getElementById('scale');\n\nlet colorPicker = <HTMLInputElement>document.getElementById('color');\n\n\nlet frame = <HTMLElement>document.getElementById('editor-frame');\nlet canvas = <HTMLCanvasElement>document.getElementById('editor');\nlet guideCanvas = <HTMLCanvasElement>document.getElementById('guide');\nlet renderCanvas = <HTMLCanvasElement>document.getElementById('render');\ncanvas.width = tileSize * editorRatio * 3;\ncanvas.height = tileSize * editorRatio * 3;\nguideCanvas.width = tileSize * editorRatio * 3;\nguideCanvas.height = tileSize * editorRatio * 3;\n\nlet sizeIndex = 2;\nlet sizeList = [1, 2, 4];\nlet pngList = [onePng, twoPng, fourPng];\nlet pixelRatio = sizeList[sizeIndex];\nrenderCanvas.width = tileSize * pixelRatio * 3;\nrenderCanvas.height = tileSize * pixelRatio * 3;\nrenderCanvas.dataset.pixelRatio = pixelRatio.toString();\n\nscaleElement.addEventListener('click', () => {\n  sizeIndex = (sizeIndex + 1) % sizeList.length;\n  scaleElement.src = pngList[sizeIndex];\n  pixelRatio = sizeList[sizeIndex];\n  renderCanvas.width = tileSize * pixelRatio * 3;\n  renderCanvas.height = tileSize * pixelRatio * 3;\n  renderCanvas.dataset.pixelRatio = pixelRatio.toString();\n  renderMap(map, pixelRatio);\n  setBorder(pixelRatio);\n  updateFrameHeight();\n});\n\nwindow.paintColor = '#000';\ncolorPicker.addEventListener('input', (e) => {\n  window.paintColor = e.target.value;\n  renderMap(map, pixelRatio);\n  setBorder(pixelRatio);\n})\n\n\nfunction updateFrameHeight() {\n  frame.style.height = canvas.getBoundingClientRect().width + 'px';\n}\ndocument.addEventListener('DOMContentLoaded', updateFrameHeight);\nwindow.addEventListener('resize', updateFrameHeight);\n\nvar isDown = false;\nvar isErasing = false;\nvar rotationalSymmetry = true;\n\nsymmetryElement.addEventListener('click', e => {\n  rotationalSymmetry = !rotationalSymmetry;\n  symmetryElement.classList.toggle('selected');\n});\n\neraserElement.addEventListener('click', e => {\n  isErasing = true;\n  eraserElement.classList.add('selected');\n  penElement.classList.remove('selected');\n});\n\npenElement.addEventListener('click', e => {\n  isErasing = false;\n  penElement.classList.add('selected');\n  eraserElement.classList.remove('selected');\n});\n\nvar map = newGrid();\nlet undoStack = [JSON.stringify(map)];\nfunction pushUndo() {\n  let candidate = JSON.stringify(map);\n  let top = undoStack[undoStack.length - 1];\n  if (candidate == top) {\n    return;\n  }\n\n  undoStack.push(candidate);\n\n  if (undoStack.length > 50) {\n    undoStack.shift();\n  }\n  undoElement.classList.add('selected');\n}\nfunction popUndo() {\n  undoStack.pop();\n  let old = undoStack[undoStack.length - 1];\n  if (old) {\n    map = JSON.parse(old);\n    cleanMap();\n    renderMap(map, pixelRatio);\n    setBorder(pixelRatio);\n  }\n}\nundoElement.addEventListener('click', e => {\n  popUndo();\n  if (undoStack.length < 2) {\n    undoElement.classList.remove('selected');\n  }\n  e.preventDefault();\n});\ndrawGuide();\nrenderMap(map, pixelRatio);\nsetBorder(pixelRatio);\n\nfunction draw(loc, v) {\n  if (isDown) {\n    setLoc(map, loc, 1 - v);\n  }\n}\nlet handleEvent = (e, isClick = false, isHover = false) => {\n  let { left, top, width, height } = canvas.getBoundingClientRect();\n  let x = e.clientX - left;\n  let y = e.clientY - top;\n  let canvasX = (x / width) * canvas.width;\n  let canvasY = (y / height) * canvas.height;\n  let gridX = Math.floor(canvasX / editorRatio);\n  let gridY = Math.floor(canvasY / editorRatio);\n\n  let rotatePairs =\n    rotationalSymmetry ? rotationSet([gridX, gridY]) : [[gridX, gridY]];\n\n  cleanMap();\n  // renderMap(map,pixelRatio);\n\n  rotatePairs.forEach(([gridX, gridY]) => {\n    let sx = Math.floor(gridX / tileSize);\n    let sy = Math.floor(gridY / tileSize);\n    let cx = gridX % tileSize;\n    let cy = gridY % tileSize;\n    let loc = [sx, sy, cx, cy];\n\n    if (sx < 0 || sx > 2 || sy < 0 || sy > 2) {\n      return;\n    }\n    if (isHover) {\n      renderHover(map, loc);\n    }\n    let v = getLoc(map, loc);\n\n    if (!isClick) {\n      v = 0;\n    }\n\n    if (isErasing) {\n      v = 1;\n    }\n    draw(loc, v);\n  });\n  renderMap(map, pixelRatio);\n  window.setTimeout(() => setBorder(pixelRatio), 0);\n};\n\ncanvas.addEventListener('mousedown', e => {\n  isDown = true;\n  handleEvent(e, true);\n});\ncanvas.addEventListener('mousemove', e => {\n  handleEvent(e, false, true);\n});\ncanvas.addEventListener('mouseout', e => {\n  cleanMap();\n  renderMap(map, pixelRatio);\n});\nwindow.addEventListener('mousedown', () => {\n  isDown = true;\n});\nwindow.addEventListener('mouseup', () => {\n  isDown = false;\n  pushUndo();\n});\ncanvas.addEventListener('touchend', e => {\n  isDown = false;\n  pushUndo();\n});\ncanvas.addEventListener('touchstart', e => {\n  isDown = true;\n\n  e.preventDefault();\n\n  const touches = e.targetTouches;\n  for (let i = 0; i < touches.length; i++) {\n    e['clientX'] = touches[i].clientX;\n    e['clientY'] = touches[i].clientY;\n    handleEvent(e);\n  }\n});\ncanvas.addEventListener('touchmove', e => {\n  e.preventDefault();\n  isDown = true;\n\n  const touches = e.targetTouches;\n  for (let i = 0; i < touches.length; i++) {\n    e['clientX'] = touches[i].clientX;\n    e['clientY'] = touches[i].clientY;\n    handleEvent(e);\n  }\n});\nlet lastTouchEnd = 0;\nwindow.addEventListener('touchend', e => {\n  // prevent double tap zoom\n  if (e.timeStamp - lastTouchEnd <= 500) {\n    e.preventDefault();\n    e.target.click();\n  }\n  isDown = false;\n  lastTouchEnd = e.timeStamp;\n});\n\nsetupGallery();\n\nexport function loadSubmissionIntoEditor(submission: submission) {\n  // Set pixel ratio\n  sizeIndex = sizeList.indexOf(submission.pixelRatio);\n  if (sizeIndex === -1) sizeIndex = 0;\n  scaleElement.src = pngList[sizeIndex];\n  pixelRatio = sizeList[sizeIndex];\n  renderCanvas.width = tileSize * pixelRatio * 3;\n  renderCanvas.height = tileSize * pixelRatio * 3;\n  renderCanvas.dataset.pixelRatio = pixelRatio.toString();\n\n  // Load image data\n  const img = new Image();\n  img.onload = () => {\n    const tempCanvas = document.createElement('canvas');\n    tempCanvas.width = img.width;\n    tempCanvas.height = img.height;\n    const tempCtx = tempCanvas.getContext('2d');\n    tempCtx.drawImage(img, 0, 0);\n    const imageData = tempCtx.getImageData(0, 0, img.width, img.height);\n\n    // Clear existing map\n    map = newGrid();\n\n    // Set color (assuming non-transparent pixels are the same color)\n    let color = null;\n\n    // Read pixel data and set locations\n    for (let y = 0; y < img.height; y++) {\n      for (let x = 0; x < img.width; x++) {\n        const i = (y * img.width + x) * 4;\n        const r = imageData.data[i];\n        const g = imageData.data[i + 1];\n        const b = imageData.data[i + 2];\n        const a = imageData.data[i + 3];\n\n        if (a > 0) {\n          const sx = Math.floor(x / (tileSize * pixelRatio));\n          const sy = Math.floor(y / (tileSize * pixelRatio));\n          const cx = Math.floor((x % (tileSize * pixelRatio)) / pixelRatio);\n          const cy = Math.floor((y % (tileSize * pixelRatio)) / pixelRatio);\n\n          setLoc(map, [sx, sy, cx, cy], 1);\n\n          if (!color) {\n            color = `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\n          }\n        }\n      }\n    }\n\n    // Set color if found\n    if (color) {\n      window.paintColor = color;\n      colorPicker.value = color;\n    }\n\n    // Render updated map\n    cleanMap();\n    renderMap(map, pixelRatio);\n    setBorder(pixelRatio);\n    pushUndo();\n  };\n  img.src = submission.dataUrl;\n}\n\n\n"],"names":["$18c11f3350a906ea$export$6503ec6e8aabbaf","$18c11f3350a906ea$export$f7ad0328861e2f03","$18c11f3350a906ea$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$298da1ce81b1d220$exports","URL","resolve","import","meta","url","toString","$18cc30ef1b720cbb$exports","$cb43c2321a81d121$exports","$9e6bd5018912b3a9$exports","selection","document","getSelection","rangeCount","active","activeElement","ranges","push","getRangeAt","tagName","toUpperCase","blur","removeAllRanges","type","forEach","range","addRange","focus","$e5a78797c4262d1f$var$clipboardToIE11Formatting","default","$e5a78797c4262d1f$exports","text","options","debug","message","reselectPrevious","mark","success","createRange","createElement","textContent","style","all","position","top","clip","whiteSpace","webkitUserSelect","MozUserSelect","msUserSelect","userSelect","addEventListener","e","stopPropagation","format","preventDefault","clipboardData","console","warn","window","clearData","setData","onCopy","body","appendChild","selectNodeContents","execCommand","err1","error","err","copyKey","test","navigator","userAgent","replace","$e5a78797c4262d1f$var$format","prompt","removeRange","removeChild","$0b89d474933103bc$export$a104aba81ad9a911","$df5bef30413a053b$export$c4a92aea75303471","Array","fill","map","v","$df5bef30413a053b$export$7b2d291483575ad6","x","y","n","$df5bef30413a053b$export$1e9173ebc1b84b","loc","r","reduce","acc","$df5bef30413a053b$export$3a11e1dabd3874c7","address","slice","lastPos","$e3d6ee63ed1479b9$var$target","getElementById","$e3d6ee63ed1479b9$var$canvas","$e3d6ee63ed1479b9$var$guideCanvas","$e3d6ee63ed1479b9$var$renderCanvas","$e3d6ee63ed1479b9$var$ctx","getContext","$e3d6ee63ed1479b9$var$guideCtx","$e3d6ee63ed1479b9$var$renderCtx","$e3d6ee63ed1479b9$export$e62d9f5f4a94939","clearRect","width","height","$e3d6ee63ed1479b9$export$fe4501d50e7230de","pixelRatio","sx","sy","cx","cy","fillStyle","paintColor","gridX","gridY","fillRect","$e3d6ee63ed1479b9$export$df6de19f3e6baa52","dataURI","toDataURL","remove","head","viewsize","css","sheet","insertRule","$e3d6ee63ed1479b9$export$2ed6d5ab9f430f6b","$e3d6ee63ed1479b9$var$resetCopy","setAttribute","$e3d6ee63ed1479b9$export$53c8df28cde915b9","title","index","styles","encodeURI","$e3d6ee63ed1479b9$var$escapeHtml","unsafe","imageSmoothingEnabled","$parcel$interopDefault","classList","setTimeout","add","$d31354e7cd32abad$var$title","$d31354e7cd32abad$var$submit","$d31354e7cd32abad$var$gallery","$d31354e7cd32abad$var$renderCanvas","$d31354e7cd32abad$var$submissions","$d31354e7cd32abad$export$f0c7f3aad087f331","submissionHTMLs","submission","dataUrl","innerHTML","join","querySelectorAll","line","target","parseInt","dataset","$543d6d2a56ed7d8d$export$6302c4d34ef6af29","async","data","fetch","then","res","json","submissions","log","$d31354e7cd32abad$var$fetchSubmissions","string","value","toLowerCase","who","method","headers","stringify","$d31354e7cd32abad$var$postSubmission","$543d6d2a56ed7d8d$var$penElement","$543d6d2a56ed7d8d$var$eraserElement","$543d6d2a56ed7d8d$var$symmetryElement","$543d6d2a56ed7d8d$var$undoElement","$543d6d2a56ed7d8d$var$scaleElement","$543d6d2a56ed7d8d$var$colorPicker","$543d6d2a56ed7d8d$var$frame","$543d6d2a56ed7d8d$var$canvas","$543d6d2a56ed7d8d$var$guideCanvas","$543d6d2a56ed7d8d$var$renderCanvas","$543d6d2a56ed7d8d$var$sizeIndex","$543d6d2a56ed7d8d$var$sizeList","$543d6d2a56ed7d8d$var$pngList","$543d6d2a56ed7d8d$var$pixelRatio","$543d6d2a56ed7d8d$var$updateFrameHeight","getBoundingClientRect","src","$543d6d2a56ed7d8d$var$map","$543d6d2a56ed7d8d$var$isDown","$543d6d2a56ed7d8d$var$isErasing","$543d6d2a56ed7d8d$var$rotationalSymmetry","toggle","$543d6d2a56ed7d8d$var$undoStack","$543d6d2a56ed7d8d$var$pushUndo","candidate","shift","pop","old","$543d6d2a56ed7d8d$var$popUndo","strokeStyle","lineWidth","beginPath","moveTo","lineTo","stroke","index1","x1","third","$543d6d2a56ed7d8d$var$handleEvent","isClick","isHover","left","clientX","clientY","canvasX","canvasY","Math","floor","rotatePairs","$543d6d2a56ed7d8d$var$draw","touches","targetTouches","$543d6d2a56ed7d8d$var$lastTouchEnd","indexOf","img","Image","onload","tempCanvas","tempCtx","drawImage","imageData","getImageData","color","g","b","padStart","timeStamp","click"],"version":3,"file":"index.eca9f7b2.js.map"}