function e(e,t,n,o){Object.defineProperty(e,t,{get:n,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o={},r={},l=n.parcelRequireed3d;null==l&&((l=function(e){if(e in o)return o[e].exports;if(e in r){var t=r[e];delete r[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}).register=function(e,t){r[e]=t},n.parcelRequireed3d=l),l.register("27Lyk",(function(t,n){var o,r;e(t.exports,"register",(()=>o),(e=>o=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var l={};o=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)l[t[n]]=e[t[n]]},r=function(e){var t=l[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),l("27Lyk").register(JSON.parse('{"6evGa":"index.dd0ef4c7.js","55edQ":"1.4174c112.png","99rIB":"2.672c92e3.png","aLMx8":"4.1e9ab26e.png"}'));var i;i=new URL(l("27Lyk").resolve("55edQ"),import.meta.url).toString();var a;a=new URL(l("27Lyk").resolve("99rIB"),import.meta.url).toString();var d;d=new URL(l("27Lyk").resolve("aLMx8"),import.meta.url).toString();var c,s;s=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],o=0;o<e.rangeCount;o++)n.push(e.getRangeAt(o));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}};var u={"text/plain":"Text","text/html":"Url",default:"Text"};c=function(e,t){var n,o,r,l,i,a,d=!1;t||(t={}),n=t.debug||!1;try{if(r=s(),l=document.createRange(),i=document.getSelection(),(a=document.createElement("span")).textContent=e,a.style.all="unset",a.style.position="fixed",a.style.top=0,a.style.clip="rect(0, 0, 0, 0)",a.style.whiteSpace="pre",a.style.webkitUserSelect="text",a.style.MozUserSelect="text",a.style.msUserSelect="text",a.style.userSelect="text",a.addEventListener("copy",(function(o){if(o.stopPropagation(),t.format)if(o.preventDefault(),void 0===o.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=u[t.format]||u.default;window.clipboardData.setData(r,e)}else o.clipboardData.clearData(),o.clipboardData.setData(t.format,e);t.onCopy&&(o.preventDefault(),t.onCopy(o.clipboardData))})),document.body.appendChild(a),l.selectNodeContents(a),i.addRange(l),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");d=!0}catch(r){n&&console.error("unable to copy using execCommand: ",r),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),d=!0}catch(r){n&&console.error("unable to copy using clipboardData: ",r),n&&console.error("falling back to prompt"),o=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(o,e)}}finally{i&&("function"==typeof i.removeRange?i.removeRange(l):i.removeAllRanges()),a&&document.body.removeChild(a),r()}return d};var f=16;function m([e,t],n=1){return[[e,t],[20-t,e],[20-e,20-t],[t,20-e]]}function g(e,t){let n=t.reduce(((e,t)=>e[t]),e);return"number"!=typeof n?0:n}let p=document.getElementById("target"),h=document.getElementById("editor"),y=document.getElementById("guide"),v=document.getElementById("render");var w=h.getContext("2d"),b=y.getContext("2d"),E=v.getContext("2d");function L(){w.clearRect(0,0,h.width,h.height)}function x(e,t){E.fill();for(let n=0;n<3;n++)for(let o=0;o<3;o++)for(let r=0;r<7;r++)for(let l=0;l<7;l++){let i=g(e,[n,o,r,l]);w.fillStyle=1==i?window.paintColor:"#fff0",E.fillStyle=1==i?window.paintColor:"#fff0";let a=(7*n+r)*t,d=(7*o+l)*t;1==n&&1==o||(E.clearRect(a,d,t,t),E.fillRect(a,d,t,t),a*=f/t,d*=f/t,w.fillRect(a+1,d+1,15,15))}}function C(e){let t=v.toDataURL(),n=document.getElementById("border-style");n&&n.remove(),n=document.createElement("style"),n.id="border-style",document.head.appendChild(n);let o=7*e,r=`.broider {\n    border-image:  url("${t}") ${o} /  ${o}px / 0 round;\n    border-width:  ${o}px;\n    border-style:  solid;\n}`;n.sheet.insertRule(r),p.textContent=r}function R(e,t){let n=7*t[0]+t[2],o=7*t[1]+t[3];w.fillStyle=(g(e,t),"#dde"),1==t[0]&&1==t[1]||w.fillRect(n*f+0,o*f+0,16,16)}function k(){p.setAttribute("data-after","[Click to copy]")}function S(e,t,n){const o=7*n,r=`border-image:  url('${encodeURI(e)}') ${o} /  ${o}px / 0 round;\n    border-width:  ${o}px;\n    border-style:  solid; `,l=`.${T(t)} {\n    ${r}\n  }`;return`\n<pre class="gallery-line" data-after="[Click to copy]" style="${T(r)}">\n  ${T(l)}\n</pre>\n  `}function T(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}E.imageSmoothingEnabled=!1,p.addEventListener("click",(function(){t(c)(p.textContent,{message:"Press #{key} to copy css"}),p.setAttribute("data-after","Copied to your clipboard!"),p.classList.remove("flash"),window.setTimeout((()=>{p.classList.add("flash")}),1),window.setTimeout(k,2500)})),k();let D=document.getElementById("title"),I=document.getElementById("submit"),B=document.getElementById("gallery"),A=document.getElementById("render"),U=[];function _(){let e=U.map((e=>S(e.dataUrl,e.title,e.pixelRatio)));B.innerHTML=e.join(""),document.querySelectorAll(".gallery-line").forEach((e=>{e.addEventListener("click",(()=>{t(c)(e.textContent),e.setAttribute("data-after","Copied to your clipboard!"),e.classList.remove("flash"),window.setTimeout((()=>{e.classList.add("flash")}),1),window.setTimeout((()=>{e.setAttribute("data-after","[Click to copy]")}),2500)}))}))}!async function(){let e=await fetch("https://maxbittker-broider.web.val.run/").then((e=>e.json()));U=e.submissions,console.log(U),_()}(),I.addEventListener("click",(()=>{let e=A.toDataURL(),t=parseInt(A.dataset.pixelRatio);var n;U.push({title:(n=D.value,(n=(n=(n=n.toLowerCase()).replace(/ /g,"-")).replace(/[^a-z0-9-_]/g,""))&&!/^[a-z_]/.test(n)&&(n="_"+n),n),dataUrl:e,pixelRatio:t,who:""}),async function(e){let t=await fetch("https://maxbittker-broider.web.val.run/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((e=>e.json()));U=t.submissions,_()}(U[U.length-1]),_()}));let O=document.getElementById("pen"),$=document.getElementById("eraser"),M=document.getElementById("symmetry"),P=document.getElementById("undo"),N=document.getElementById("scale"),H=document.getElementById("color"),j=document.getElementById("editor-frame"),X=document.getElementById("editor"),F=document.getElementById("guide"),J=document.getElementById("render");X.width=336,X.height=336,F.width=336,F.height=336;let Y=2,q=[1,2,4],z=[t(i),t(a),t(d)],Q=q[Y];function G(){j.style.height=X.getBoundingClientRect().width+"px"}J.width=7*Q*3,J.height=7*Q*3,J.dataset.pixelRatio=Q.toString(),N.addEventListener("click",(()=>{Y=(Y+1)%q.length,N.src=z[Y],Q=q[Y],J.width=7*Q*3,J.height=7*Q*3,J.dataset.pixelRatio=Q.toString(),x(Z,Q),C(Q),G()})),window.paintColor="#000",H.addEventListener("input",(e=>{window.paintColor=e.target.value,x(Z,Q),C(Q)})),document.addEventListener("DOMContentLoaded",G),window.addEventListener("resize",G);var W=!1,K=!1,V=!0;M.addEventListener("click",(e=>{V=!V,M.classList.toggle("selected")})),$.addEventListener("click",(e=>{K=!0,$.classList.add("selected"),O.classList.remove("selected")})),O.addEventListener("click",(e=>{K=!1,O.classList.add("selected"),$.classList.remove("selected")}));var Z=new Array(3).fill(0).map(((e,t)=>new Array(3).fill(0).map(((e,t)=>new Array(7).fill(0).map(((e,t)=>new Array(7).fill(0)))))));let ee=[JSON.stringify(Z)];function te(){let e=JSON.stringify(Z);e!=ee[ee.length-1]&&(ee.push(e),ee.length>50&&ee.shift(),P.classList.add("selected"))}P.addEventListener("click",(e=>{!function(){ee.pop();let e=ee[ee.length-1];e&&(Z=JSON.parse(e),L(),x(Z,Q),C(Q))}(),ee.length<2&&P.classList.remove("selected"),e.preventDefault()})),function(){for(let e=1;e<3;e++){b.strokeStyle="#33f",b.lineWidth=.5;let t=e*h.width/3;b.beginPath(),b.moveTo(t,0),b.lineTo(t,h.height),b.stroke(),b.beginPath(),b.moveTo(0,t),b.lineTo(h.height,t),b.stroke()}for(let e=0;e<21;e++){b.strokeStyle="#ccc";let t=e*h.width/21;b.beginPath(),b.moveTo(t,0),b.lineTo(t,h.height),b.stroke(),b.beginPath(),b.moveTo(0,t),b.lineTo(h.height,t),b.stroke()}let e=h.width/3;b.clearRect(e+1,e+1,e-2,e-2),b.beginPath(),b.moveTo(1*e,2*e),b.lineTo(2*e,1*e),b.stroke(),b.beginPath(),b.moveTo(1*e,1*e),b.lineTo(2*e,2*e),b.stroke()}(),x(Z,Q),C(Q);let ne=(e,t=!1,n=!1)=>{let{left:o,top:r,width:l,height:i}=X.getBoundingClientRect(),a=e.clientX-o,d=e.clientY-r,c=a/l*X.width,s=d/i*X.height,u=Math.floor(c/f),p=Math.floor(s/f),h=V?m([u,p]):[[u,p]];L(),h.forEach((([e,o])=>{let r=Math.floor(e/7),l=Math.floor(o/7),i=[r,l,e%7,o%7];if(r<0||r>2||l<0||l>2)return;n&&R(Z,i);let a=g(Z,i);t||(a=0),K&&(a=1),function(e,t){W&&function(e,t,n=1){let o=t.slice(0,-1),r=t[t.length-1];o.reduce(((e,t)=>e[t]),e)[r]=n}(Z,e,1-t)}(i,a)})),x(Z,Q),window.setTimeout((()=>C(Q)),0)};X.addEventListener("mousedown",(e=>{W=!0,ne(e,!0)})),X.addEventListener("mousemove",(e=>{ne(e,!1,!0)})),X.addEventListener("mouseout",(e=>{L(),x(Z,Q)})),window.addEventListener("mousedown",(()=>{W=!0})),window.addEventListener("mouseup",(()=>{W=!1,te()})),X.addEventListener("touchend",(e=>{W=!1,te()})),X.addEventListener("touchstart",(e=>{W=!0,e.preventDefault();const t=e.targetTouches;for(let n=0;n<t.length;n++)e.clientX=t[n].clientX,e.clientY=t[n].clientY,ne(e)})),X.addEventListener("touchmove",(e=>{e.preventDefault(),W=!0;const t=e.targetTouches;for(let n=0;n<t.length;n++)e.clientX=t[n].clientX,e.clientY=t[n].clientY,ne(e)}));let oe=0;window.addEventListener("touchend",(e=>{e.timeStamp-oe<=500&&(e.preventDefault(),e.target.click()),W=!1,oe=e.timeStamp})),_();
//# sourceMappingURL=index.dd0ef4c7.js.map
